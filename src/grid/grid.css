:root {
  /* layout */
  --rows: 0;
  --cols: 0;
  --block-width: 100vw;
  --block-height: 100vh;
  --block-gap: 10px;
  --header-row: -1; /* What row is the header, that the items 'avoid'

  /* easing & durations (CSS-owned; JS only sets fade-out) */
  --ease: cubic-bezier(0.3,0,0.7,1);
  --duration: 300ms;
  --hover-transition-duration: 0ms;
  --fade-in-duration: 250ms;
  --fade-out-duration: 200ms;

  /* visuals */
  --block-border-color: hsl(30, 100%, 60%); /* bright orange */
  --block-background-color: hsl(240, 73%, 47%);

  --background-color: hsl(0, 0%, 0%); /* deep black */
  --grid-color-vertical: hsl(200, 80%, 50%); /* sky blue */
  --grid-color-horizontal: hsl(330, 90%, 65%); /* hot pink */
  
  --text-color: hsl(50, 80%, 90%); /* pale yellow/cream */
  --header-sub-color: hsl(180, 60%, 70%); /* light aqua/mint */
  --header-main-color: hsl(330, 90%, 70%); /* hot pink/magenta */
  --default-font-weight: 400;
  
  --tag-text-color: hsl(50, 80%, 90%); /* pale yellow/cream */
  --tag-background-color: hsl(240, 73%, 47%); /* deep blue/indigo */
  
  --tag-active-background-color: var(--header-sub-color);
  --tag-active-text-color: hsl(0, 0%, 0%); /* black for contrast */
  
  --tag-hover-background-color: hsl(330, 90%, 70%); /* hot pink/magenta */
  --tag-hover-text-color: hsl(50, 80%, 90%); /* pale yellow/cream */

  --tag-header-text-color: hsl(50, 80%, 90%); /* pale yellow/cream */
  --tag-header-background-color:  hsl(270, 92%, 53%);
  
  --tag-header-active-background-color:  var(--header-sub-color);
  --tag-header-active-text-color: hsl(0, 0%, 0%); /* black for contrast */
  
  --tag-header-hover-background-color: hsl(330, 90%, 70%); /* hot pink/magenta */
  --tag-header-hover-text-color: hsl(50, 80%, 90%); /* pale yellow/cream */

  /* dashed border animation */
  --border: 10px;   /* border thickness */
  --cell: 10px;     /* checker size (dash length) */
  --speed: 500ms;   /* hover animation duration */
  --dash-color-1: #000;
  --dash-color-2: #fff;
}

/* Grid-specific styles moved from main.css */
.block-border {
  transition: border-color var(--hover-transition-duration) linear;
  border: 5px solid var(--block-border-color);
}

.tags {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  padding-top: 20px;

  & .tag {
    pointer-events: auto;
    cursor: pointer;
    color: var(--tag-text-color);
    background-color: var(--tag-background-color);
    padding: 5px 10px;
    color: white;

    transition: background-color 150ms linear, color 150ms linear;
    
    /* border: 2px solid white; */

    &:hover {
      background-color: var(--tag-hover-background-color);
      color: var(--tag-hover-text-color);
    }
    &.active {  
      background-color: var(--tag-active-background-color);
      color: var(--tag-active-text-color);
    }
  }
}

#grid {
  position: relative;
  z-index: 5;
  width: 100%;
  height: 100%;
  gap: var(--block-gap);
  display: flex;
  flex-wrap: wrap;
  align-content: flex-start;

  overflow: auto;
  scrollbar-gutter: stable;
  overscroll-behavior: contain;
  scroll-snap-type: y mandatory;
}

#grid > .block {
  position: relative;
  cursor: pointer;
  
  width: var(--block-width);
  height: var(--block-height);

  background-color: var(--block-background-color);

  will-change: transform;
  transition: transform var(--duration) var(--ease);

  overflow: hidden;
}

/* Full-bleed media fills the card ignoring padding */
#grid > .block .media {
  position: absolute;
  inset: 0;
  z-index: 0;
}

#grid > .block .media img.thumb {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transform-origin: center center;

  /* will-change: transform;
  transition: transform 200ms ease-in-out; */
}

/* Two-image vertical split (legacy) */
/* Two-image overflow stack: second image starts just below container */
#grid > .block .media img.thumb {
  inset: auto;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* Foreground content sits above media and respects padding */
#grid > .block .content {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
  padding: calc(var(--block-gap) * 0.5);
  & h3, & p {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 400;
    font-style: normal;
    display: inline-block;
    padding: 8px 10px;
    /* padding: 0 5px; */
    /* background-color: rgba(0, 0, 0, 0.5); */
    font-size: 12px;
    line-height: 1;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    user-select: none;
    -webkit-user-select: none;
    background-color: black;
    color: white;
  }
}

#grid > .block .content .tags {
  flex-wrap: wrap-reverse;
  align-content: flex-start;
}

.col-0 {
  scroll-snap-align: start;
}

.above-header  {
  transform: translateY(calc(-1 * (var(--block-height) + var(--block-gap))));
}

.row-spacer {
  width: 100%;
  height: var(--block-height);
}

.checker-border {
  position: absolute;
  z-index: 10;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: visible; /* avoids clipping stroke that sits half outside */
  opacity: 0;
  transition: opacity var(--hover-transition-duration) linear;
}

/* We size/position the <rect> purely via CSS.
   Inset by half the stroke so the border sits INSIDE the box. */
.checker-border .dash {
  /* Geometry (SVG 2 properties supported in modern browsers) */
  x: calc(var(--border) / 2);
  y: calc(var(--border) / 2);
  width: calc(100% - var(--border));
  height: calc(100% - var(--border));

  /* Stroke styling */
  fill: none;
  stroke-width: var(--border);
  stroke-linecap: butt;
  stroke-dasharray: var(--cell) var(--cell);  /* 10px on, 10px off */
}

/* Two tracks offset to create the checker pattern */
.checker-border .black { stroke: var(--dash-color-1); stroke-dashoffset: 0; }
.checker-border .white { stroke: var(--dash-color-2); stroke-dashoffset: var(--cell); }

/* Animate only on hover */
#grid > .block:hover .checker-border {opacity: 1;}
#grid > .block:hover .black { animation: marchBlack var(--speed) linear infinite; }
#grid > .block:hover .white { animation: marchWhite var(--speed) linear infinite; }
#grid > .block:hover .block-border { border-color: transparent;}
/* Move both colors by exactly one full pattern length (dash + gap) */
@keyframes marchBlack {
  to { stroke-dashoffset: calc(-1 * (var(--cell) * 2)); }
}
/* White track starts offset by one cell, so end at -cell to move the same distance */
@keyframes marchWhite {
  to { stroke-dashoffset: calc(-1 * var(--cell)); }
}

#header {
  z-index: 0;

  & .tags > .tag {
      /* font-size: max(1rem, 2vw); */
      color: var(--tag-header-text-color);
      background-color: var(--tag-header-background-color);
      &:hover {
        background-color: var(--tag-header-hover-background-color);
        color: var(--tag-header-hover-text-color);
      }
      &.active {
        background-color: var(--tag-header-active-background-color);
        color: var(--tag-header-active-text-color);
      }
  }
}

.fixed-header {
  position: fixed;
  width: 100%;
  top: calc(var(--header-row) * (var(--block-height) + var(--block-gap)));
  height: var(--block-height);
  pointer-events: none;
  z-index: 0;

  border: 10px solid transparent;
  
  /* Hide initially until first resize */
  opacity: 0;
  transition: opacity 300ms ease-in-out;
}

/* Show all fixed headers after layout is ready */
.layout-ready .fixed-header { opacity: 1; }

/* Only fade-in the main header (#header) with a small delay */
@keyframes headerFadeIn { from { opacity: 0; } to { opacity: 1; } }
.layout-ready #header.fixed-header {
  animation-name: headerFadeIn;
  animation-duration: 200ms;
  animation-timing-function: ease-out;
  animation-fill-mode: both;
  animation-delay: var(--header-fade-delay, 1000ms);
}

/**
 * Measure viewport element used to calculate the size of blocks to be rendered on the site
 */
#measure-viewport {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  height: 100lvh;
  /* Draw grid gaps as lines, sized by --block-gap and spaced by block size */
  background-image:
    repeating-linear-gradient(
      to right,
      transparent 0,
      transparent var(--block-width),
      var(--grid-color-vertical) var(--block-width),
      var(--grid-color-vertical) calc(var(--block-width) + var(--block-gap))
    ),
    repeating-linear-gradient(
      to bottom,
      transparent 0,
      transparent var(--block-height),
      var(--grid-color-horizontal) var(--block-height),
      var(--grid-color-horizontal) calc(var(--block-height) + var(--block-gap))
    );
  background-blend-mode: normal;
  background-repeat: repeat;
  background-position: 0 0;
  background-size: auto;
  
  z-index: 0;

  pointer-events: none;
  user-select: none;
  -webkit-user-select: none;
  -webkit-user-drag: none;
  -webkit-app-region: drag;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  -webkit-user-select: none;
  -webkit-user-drag: none;
  -webkit-app-region: drag;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  
  /* Hide grid initially until first resize */
  opacity: 0;
  transition: opacity 300ms ease-in-out;
}

/* Show background grid after layout is ready */
.layout-ready #measure-viewport {
  opacity: 1;
}

/* Fade animations for blocks (independent of transform transitions) */
@keyframes fadeInQuick {
  from { opacity: 0; scale: 0.9; }
  to { opacity: 1; scale: 1; }
}
@keyframes fadeOutQuick {
  from { opacity: 1; scale: 1; }
  to { opacity: 0; scale: 0.9; }
}

#grid > .block.fade-in {
  animation-name: fadeInQuick;
  animation-duration: var(--fade-in-duration);
  animation-timing-function: ease-out;
  animation-fill-mode: both;
  animation-delay: var(--fade-delay, 0ms);
}

#grid > .block.fade-out {
  animation-name: fadeOutQuick;
  animation-duration: var(--fade-out-duration);
  animation-timing-function: ease-in;
  animation-fill-mode: both;
  pointer-events: none;
  animation-delay: 0ms;
}

